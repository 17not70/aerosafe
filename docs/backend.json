
{
  "entities": {
    "Report": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Report",
      "type": "object",
      "description": "Represents a safety report, either voluntary (VSR) or mandatory (MOR).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the report."
        },
        "type": {
          "type": "string",
          "description": "Type of the report (VSR or MOR)."
        },
        "title": {
          "type": "string",
          "description": "Title of the report."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the safety event."
        },
        "severity": {
          "type": "number",
          "description": "Severity of the safety event (e.g., on a scale of 1-5)."
        },
        "probability": {
          "type": "number",
          "description": "Probability of the safety event occurring again (e.g., on a scale of 1-5)."
        },
        "risk_index": {
          "type": "number",
          "description": "Calculated risk index (Severity x Probability)."
        },
        "action_status": {
          "type": "string",
          "description": "Current status of corrective actions (e.g., Open, In Progress, Closed)."
        },
        "attachments": {
          "type": "array",
          "description": "References to attachments stored in Cloud Storage.",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "url": {
                "type": "string"
              }
            },
            "required": ["name", "url"]
          }
        },
        "reporter_id": {
          "type": "string",
          "description": "Reference to User who submitted the report. (Relationship: User 1:N Report)"
        },
        "created_at": {
          "type": "string",
          "description": "Timestamp of when the report was created.",
          "format": "date-time"
        },
        "hazardType": {
          "type": "string",
          "description": "Category of the hazard reported."
        }
      },
      "required": [
        "id",
        "type",
        "title",
        "description",
        "severity",
        "probability",
        "risk_index",
        "action_status",
        "reporter_id",
        "created_at"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the AeroSafe Insights application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "name": {
          "type": "string",
          "description": "Full name of the user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "Role of the user (Reporter, Safety Officer, Admin)."
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "role"
      ]
    },
    "CorrectiveAction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CorrectiveAction",
      "type": "object",
      "description": "Represents a corrective or preventative action taken in response to a safety report.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the corrective action."
        },
        "report_id": {
          "type": "string",
          "description": "Reference to the Report this action is associated with. (Relationship: Report 1:N CorrectiveAction)"
        },
        "assigned_to_id": {
          "type": "string",
          "description": "Reference to User assigned to this action. (Relationship: User 1:N CorrectiveAction)"
        },
        "description": {
          "type": "string",
          "description": "Description of the corrective action."
        },
        "due_date": {
          "type": "string",
          "description": "Date by which the action should be completed.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Current status of the action (e.g., Open, In Progress, Closed)."
        }
      },
      "required": [
        "id",
        "report_id",
        "assigned_to_id",
        "description",
        "due_date",
        "status"
      ]
    },
    "AuditLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AuditLog",
      "type": "object",
      "description": "Represents an audit log entry for tracking user actions.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the audit log entry."
        },
        "actorId": {
          "type": "string",
          "description": "Reference to User who performed the action. (Relationship: User 1:N AuditLog)"
        },
        "action": {
          "type": "string",
          "description": "Description of the action performed (e.g., 'Report submitted', 'User updated')."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the action was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "actorId",
        "action",
        "timestamp"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "collections": {
      "users": {
        "schema": {
          "$ref": "#/entities/User"
        },
        "description": "Stores user profiles. The document ID is the Firebase Auth UID."
      },
      "reports": {
        "schema": {
          "$ref": "#/entities/Report"
        },
        "description": "Stores all safety reports. Security rules will control access based on user role."
      },
      "corrective_actions": {
        "schema": {
          "$ref": "#/entities/CorrectiveAction"
        },
        "description": "Stores all corrective actions."
      },
      "audit_logs": {
        "schema": {
          "$ref": "#/entities/AuditLog"
        },
        "description": "Stores audit trail information for administrative oversight."
      },
      "roles_admin": {
        "schema": {
          "$ref": "#/entities/User"
        },
        "description": "Collection to store UIDs of admin users. Existence in this collection grants admin privileges."
      },
      "roles_safety_officer": {
        "schema": {
          "$ref": "#/entities/User"
        },
        "description": "Collection to store UIDs of safety officer users. Existence in this collection grants safety officer privileges."
      }
    }
  }
}
